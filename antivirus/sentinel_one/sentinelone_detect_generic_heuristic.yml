# Based https://docs.cyderes.cloud/parser-knowledge-base/sentinel_edr/#parser-details
# And https://xsoar.pan.dev/docs/reference/integrations/sentinel-one-v2
# And https://www.sentinelone.com/blog/feature-spotlight-introducing-the-new-threat-center/
# Rule version v1.0.0

- name: "Sentinelone possible detection of threat with Generic Heuristic"
  severity: "High"
  description: "Heuristic analysis is based on several techniques. 
                These techniques scan the source codes of the files and compare them to previously discovered threats. 
                Depending on the match ratio, the system will find the probability of a threat and flag code that is likely to be malicious.
                Heuristic-based analysis uses a number of techniques to analyze behaviors and threat levels, including:
                Dynamic Analysis: Analyzes the behavior of a file in a simulated environment.
                File Analysis: Analyzes the intent, destination, and purpose of a file.
                Multi-criteria analysis (MCA): analyzes the weight of the potential threat.
                Heuristic virus scans use these scanning techniques to detect viruses within code."
  solution: "Install anti-virus/malware software to keep your PC virus free. Keep your antivirus 
             software up to date. Run regularly scheduled scans with your antivirus software. 
             Keep your operating system up to date. Protect your red."
  category: "Impact"
  tactic: "Data Manipulation"
  reference:
    - "https://attack.mitre.org/tactics/TA0040/"
    - "https://attack.mitre.org/techniques/T1565/"
  frequency: 60
  cache: 
    - allOf:
        - field: "logx.sentinel_one.threatClassification"
          operator: "::"
          value: "Generic.Heuristic"
      minCount: 1
      timeLapse: 60
      save:
        - field: "logx.sentinel_one.proto"
          alias: "Protocol"
        - field: "logx.sentinel_one.suser"
          alias: "SourceUser"
        - field: "logx.sentinel_one.src_ip"
          alias: "SourceIP"
        - field: "logx.sentinel_one.duser"
          alias: "DestinationUser"
        - field: "logx.sentinel_one.dest_ip"
          alias: "DestinationIP"